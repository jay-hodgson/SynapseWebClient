<!doctype html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>iframe communication test</title>
  </head>

  <body onload="javascript:initMessageListener()">
	<p>The field below is populated by a postMessage from the parent window.</p>
	<p>When the button is clicked, a message is sent back to the parent, and containing the text "success"</p>
	<form>
		First name: <input type="text" id="firstname_field" name="firstname"><br>
		<button type="button" onclick="signup()">Sign up</button>
	</form>
	
	<script>
		
		function initMessageListener() {
			processMessage = function(e) {
				// e.data is the string sent by the origin with postMessage.
				document.getElementById('firstname_field').value = e.data;
			}
			//listen for 'message' type
			window.addEventListener('message', processMessage, false);
		}
		
		function signup() {
			//send status back to sender
			window.parent.postMessage('success', '*');
			console.log('posted success message');
		}
	</script>
  </body>
</html>